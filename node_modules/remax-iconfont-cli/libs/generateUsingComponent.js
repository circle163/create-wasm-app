"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
var tslib_1 = require("tslib");
var path_1 = tslib_1.__importDefault(require("path"));
var fs_1 = tslib_1.__importDefault(require("fs"));
var getTemplate_1 = require("./getTemplate");
var replace_1 = require("./replace");
exports.generateUsingComponent = function (config, names, platform) {
    var saveDir = path_1.default.resolve(config.save_dir);
    var jsxExtension = config.use_typescript ? '.tsx' : '.js';
    var iconFile;
    if (platform) {
        if (fs_1.default.existsSync(path_1.default.join(__dirname, '../templates/index.' + platform + jsxExtension + '.template'))) {
            iconFile = getTemplate_1.getTemplate('index.' + platform + jsxExtension);
        }
        else {
            iconFile = getTemplate_1.getTemplate('index.platform' + jsxExtension);
        }
    }
    else {
        iconFile = getTemplate_1.getTemplate('index' + jsxExtension);
    }
    iconFile = replace_1.replaceNames(iconFile, names);
    iconFile = replace_1.replaceSize(iconFile, config.default_icon_size);
    iconFile = replace_1.replaceIsRpx(iconFile, config.use_rpx);
    if (platform) {
        iconFile = replace_1.replacePlatform(iconFile, platform);
    }
    if (!platform && !config.use_typescript) {
        var definitionFile = getTemplate_1.getTemplate('index.d.ts');
        definitionFile = replace_1.replaceNames(definitionFile, names);
        fs_1.default.writeFileSync(path_1.default.join(saveDir, 'index.d.ts'), definitionFile);
    }
    fs_1.default.writeFileSync(path_1.default.join(saveDir, 'index' + (platform ? "." + platform : '') + jsxExtension), iconFile);
};
